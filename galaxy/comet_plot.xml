<?xml version="1.0"?>
<tool id="comet_plot" name="Comet Plot" version="0.0.1">
<description>plot DMPs with coMET</description>

<command>
	#import re
	#set inputDir=$re.sub("\.dat","_files",str($input))
	#set outputDir=$re.sub("\.dat","_files/",str($html))

	Rscript $__tool_directory__/../R/comet_plot.r 
	--meth $inputDir/meth.rdata
	--win $win
	--max $max
	
	#if $dmps != ""
	--dmps $dmps
	#end if
	--output $html.files_path;
	
	mv $html.files_path/* $inputDir/. ;
	cp $inputDir/index.html $input;
	mkdir $outputDir;
	ln -sfvn $inputDir/* $outputDir/.;
	cp $input $html; 
</command>

<inputs>
	<param name="input" type="data" format="html" label="DMPs report" />
	<param name="win" type="text" value="10000" label="Windows size" />
	<param name="max" type="text" value="10" label="Max dmps to plot" />
	<param name="dmps" type="text" value="" label="dmp to plot" /> 
</inputs>

<outputs>
	<data name="html" format="html" label="coMET" />
</outputs>

<stdio>

<regex match="Warning message:"
           source="both"
           level="warning"
           description="Warning message:" />
    <regex match="error"
           source="both"
           level="fatal"
           description="error encountered" />
</stdio>


<help>

</help>

</tool>
