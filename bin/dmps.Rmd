---
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    
params:
  project: "methylkey5"
  model: "Case_vs_Control"
  formula: "~variable"
  
title: "`r params$project`"
---


```{r include = FALSE}
  library(knitr)
  library(data.table)
  path=paste0(params$project,"/",params$model,"/dmps/")
```

#DMPs `r params$model`

## 1  {.tabset .tabset-fade .tabset-pills}

```{r}
  print(paste0("Model = ", params$formula, " [", params$model, "]"))
```

### QQplot

[ ![](`r params$project`/`r params$model`/dmps/qqplot.jpg) ](`r params$project`/`r params$model`/dmps/qqplot.jpg)

### Heatmap

[ ![](`r params$project`/`r params$model`/dmps/heatmap.jpg) ](`r params$project`/`r params$model`/dmps/heatmap.jpg)

### Toptable

[ download ](`r params$project`/`r params$model`/dmps/toptable.txt)

```{r, results='asis'}
toptable<-fread(paste0(params$project,"/",params$model,"/dmps/toptable.txt"), header=T,nrows=100)
kable(toptable)

```

### Annotation

[ download ](`r params$project`/`r params$model`/dmps/annotated.txt)

```{r, results='asis'}
annotation<-fread(paste0(params$project,"/",params$model,"/dmps/annotated.txt"), header=T,nrows=100)
kable(annotation)

```

### Barplots

[ ![](`r params$project`/`r params$model`/dmps/genes_barplot.jpg){ width=50% } ](`r params$project`/`r params$model`/dmps/genes_barplot.jpg)

[ ![](`r params$project`/`r params$model`/dmps/cpgi_barplot.jpg){ width=50% } ](`r params$project`/`r params$model`/dmps/cpgi_barplot.jpg)


```{r, echo=FALSE}
  show_text <- FALSE
  if ("chromHMM_barplot.jpg" %in% list.files(paste0(params$project,"/",params$model,"/dmps/"))) {
    show_text <- TRUE
  }
  print(show_text)
```

```{r, eval = show_text, results='asis'}

cat("\n\n### Histone marker\n\n")
cat("[ ![](", paste0(params$project, "/", params$model, "/dmps/chromHMM_barplot.jpg"), "){ width=50% } ]")
cat("(", paste0(params$project,"/",params$model, "/dmps/chromHMM_barplot.jpg"), ")\n\n")

```







