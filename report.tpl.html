<html>
<head>
</head>
<body>
Samples : {{ samples }}<br/>
Platform : {{ platform }}<br/>
package : {{ package }}<br/>
Normalisation : {{ normalize }}<br/>
Probes : {{ nbprobes3 }}/{{ nbprobes1 }} ({{ nbprobes1-nbprobes3 }} filtered) <br/>
Excluded from list = {{ nbprobes1-nbprobes2 }} ( SNP_EPIC.csv,Sex_EPIC.csv )</br>
Missing values : {{ missing }}<br/>
Excluded because NA > 20% (<a href="removed.txt">{{ nbprobes2-nbprobes3 }}</a>)<br/>
Cell mixture composition : {{ cell }} <br/>
<a href="report.html_files/pdata.txt">pdata</a><br/>
<a href="report.html_files/betas.txt">betas</a><br/>
<a href="report.html_files/deltabetas.txt">DeltaBetas</a><br/>

</br></br>
<HR>
<h1>Signal intensities distribution</h1>

<table>
<tr>
<td><a href="{{ out }}/boxplot_colour1.jpg"><img src="{{ out }}/boxplot_colour1.jpg" width="500" height="500" /></a></td>
<td><a href="{{ out }}/plotQC.jpg"><img src="{{ out }}/plotQC.jpg" width="500" height="500" /></a></td>
</tr>
<tr>
<td><a href="{{ out }}/methylated1.jpg"><img src="{{ out }}/methylated1.jpg" width="500" height="500" /></a></td>
<td><a href="{{ out }}/unmethylated1.jpg"><img src="{{ out }}/unmethylated1.jpg" width="500" height="500" /></a></td>
</tr>
</table>

</br></br>
<HR>
<h1>Betas distribution by group</h1>

<select id="toogle" onchange="setPicture(this);">
{{ options }}
</select>

<table>
<tr align="center">
<td><b>Unfiltered</b></td><td><b>Filtered</b></td>
</tr>
<tr>
<td><a href="{{ out }}/{{ group }}/densityPlot1.jpg"><img class="gpt" src="{{ out }}/{{ group }}/densityPlot1.jpg" width="500" height="500"/></a></td>
<td><a href="{{ out }}/{{ group }}/densityPlot2.jpg"><img class="gpt"  src="{{ out }}/{{ group }}/densityPlot2.jpg" width="500" height="500"/></a></td>
</tr>
<tr>
<td><a href="{{ out }}/{{ group }}/densityBeanPlot1.jpg"><img class="gpt" src="{{ out }}/{{ group }}/densityBeanPlot1.jpg" width="500" height="500"/></a></td>
<td><a href="{{ out }}/{{ group }}/densityBeanPlot2.jpg"><img class="gpt"  src="{{ out }}/{{ group }}/densityBeanPlot2.jpg" width="500" height="500"/></a></td>
</tr>
<tr>
<td><a href="{{ out }}/{{ group }}/mdsPlot1.jpg"><img class="gpt"  src="{{ out }}/{{ group }}/mdsPlot1.jpg" width="500" height="500"/></a></td>
<td><a href="{{ out }}/{{ group }}/mdsPlot2.jpg"><img class="gpt"  src="{{ out }}/{{ group }}/mdsPlot2.jpg" width="500" height="500"/></a></td>
</tr>
</table>

</br></br>
<HR>
<h1>PCA</h1>

<table>
<tr align="center">
<td><img class="gpt"  src="{{ out }}/pca_contributions.jpg" width="500" height="500"/></td>
<td>{{ tab_qvalue }}</td>
<tr>
</table>

</br></br>
<HR>
<h1>Violin plots</h1>

<table>
<tr align="center">
<td><img class="gpt"  src="{{ out }}/violin1.jpg" width="500" height="500"/></td>
<td><img class="gpt"  src="{{ out }}/violin2.jpg" width="500" height="500"/></td>
<td><img class="gpt"  src="{{ out }}/violin3.jpg" width="500" height="500"/></td>
</tr>
</table>

</body>
<script type="text/javascript">

/*to color table of pvalues*/
(function () {

    var table = document.getElementsByTagName("table")[0]; 
    var cellules = table.getElementsByTagName("td");
    for (var i = 0; i < cellules.length; i++) {
        if ( cellules[i].textContent < 0.05) {
            cellules[i].style.backgroundColor = "lightskyblue1";
        }
	if ( cellules[i].textContent < 0.01) {
            cellules[i].style.backgroundColor = "lightskyblue3";
        }
	if ( cellules[i].textContent < 0.001) {
            cellules[i].style.backgroundColor = "skyblue1";
        }
	if ( cellules[i].textContent < 0.0001) {
            cellules[i].style.backgroundColor = "deepskyblue1";
        }
	if ( cellules[i].textContent < 0.00001) {
            cellules[i].style.backgroundColor = "royalblue3";
        }
    }

})();

/*group selection*/
var selection="{{group}}";

function setPicture(select) {
var images = document.getElementsByClassName("gpt");
for(i=0;i<images.length;i++)
{
images[i].src = images[i].src.replace(selection, select.options[select.selectedIndex].value)
}
selection=select.options[select.selectedIndex].value
}

</script>

</html>
