<?xml version="1.0"?>
<tool id="dmrplot" name="DMR plot" version="0.2.1">
<description>plot DMRs with DMRcate</description>

<requirements>
    <requirement type="package" version="2.0" >r-methylkey</requirement>
</requirements>

<command>
	#import re
	#set inputDir=$re.sub("\.dat","_files",str($input))

	cp $__tool_directory__/../bin/methylkey_plotDMRs.Rmd index.Rmd;

	mkdir $html.files_path;

	Rscript -e "rmarkdown::render('index.Rmd', params=list( 

	meth='$inputDir/report/meth.rdata' ,
	max=$max ,
	dmrs='$dmrs' ,
	out='report'))";
	
	mv report $html.files_path/.;
</command>

<inputs>
	<param name="input" type="data" format="html" label="DMPs report" />
	<param name="max" type="text" value="10" label="Max dmps to plot" />
	<param name="dmrs" type="text" value="" label="dmrs to plot" /> 
</inputs>

<outputs>
	<data name="html" format="html" label="DMRplot on ${on_string}" from_work_dir="index.html"/>
</outputs>

<stdio>

<regex match="Warning message:"
           source="both"
           level="warning"
           description="Warning message:" />
    <regex match="error"
           source="both"
           level="fatal"
           description="error encountered" />
</stdio>


<help>

</help>

</tool>
